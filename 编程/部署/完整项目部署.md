# ðŸš€ è‹¥ä¾èžèµ„é¡¹ç›®æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—

---

## ðŸ“‹ ç›®å½•

1. [ç³»ç»ŸçŽ¯å¢ƒå‡†å¤‡](#1-ç³»ç»ŸçŽ¯å¢ƒå‡†å¤‡)
2. [Docker çŽ¯å¢ƒæ­å»º](#2-docker-çŽ¯å¢ƒæ­å»º)
3. [åŸºç¡€æœåŠ¡éƒ¨ç½²](#3-åŸºç¡€æœåŠ¡éƒ¨ç½²)
4. [Java åŽç«¯éƒ¨ç½²](#4-java-åŽç«¯éƒ¨ç½²)
5. [Python çˆ¬è™«æœåŠ¡éƒ¨ç½²](#5-python-çˆ¬è™«æœåŠ¡éƒ¨ç½²)
6. [å‰ç«¯éƒ¨ç½²](#6-å‰ç«¯éƒ¨ç½²)
7. [Nginx åå‘ä»£ç†é…ç½®](#7-nginx-åå‘ä»£ç†é…ç½®)
8. [æœåŠ¡ç®¡ç†ä¸Žç›‘æŽ§](#8-æœåŠ¡ç®¡ç†ä¸Žç›‘æŽ§)
9. [å¸¸è§é—®é¢˜æŽ’æŸ¥](#9-å¸¸è§é—®é¢˜æŽ’æŸ¥)

---

## 1. ç³»ç»ŸçŽ¯å¢ƒå‡†å¤‡

### 1.1 æœåŠ¡å™¨è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: CentOS 7.x / Rocky Linux 8.x
- **CPU**: 2æ ¸åŠä»¥ä¸Š
- **å†…å­˜**: 4GBåŠä»¥ä¸Š
- **ç£ç›˜**: 50GBåŠä»¥ä¸Š
- **ç½‘ç»œ**: å…¬ç½‘IPï¼Œå¼€æ”¾ 80ã€443 ç«¯å£

### 1.2 åŸºç¡€è½¯ä»¶å®‰è£…

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo yum update -y

# å®‰è£…åŸºç¡€å·¥å…·
sudo yum install -y wget curl vim git net-tools

# å®‰è£… Python 3.9+
sudo yum install -y python39 python39-devel

# å®‰è£… Java 17
sudo yum install -y java-17-openjdk java-17-openjdk-devel

# éªŒè¯å®‰è£…
python3.9 --version
java -version
```

### 1.3 åˆ›å»ºé¡¹ç›®ç›®å½•

```bash
# åˆ›å»ºé¡¹ç›®æ ¹ç›®å½•
sudo mkdir -p /opt/financing-projects
sudo mkdir -p /opt/docker

# è®¾ç½®æƒé™
sudo chown -R $USER:$USER /opt/financing-projects
sudo chown -R $USER:$USER /opt/docker
```

---

## 2. Docker çŽ¯å¢ƒæ­å»º

### 2.1 å®‰è£… Docker

```bash
# å¸è½½æ—§ç‰ˆæœ¬
sudo yum remove -y docker docker-client docker-client-latest \
    docker-common docker-latest docker-latest-logrotate \
    docker-logrotate docker-engine

# å®‰è£…ä¾èµ–
sudo yum install -y yum-utils device-mapper-persistent-data lvm2

# æ·»åŠ  Docker ä»“åº“
sudo yum-config-manager --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo

# å®‰è£… Docker
sudo yum install -y docker-ce docker-ce-cli containerd.io

# å¯åŠ¨ Docker
sudo systemctl start docker
sudo systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
```

### 2.2 å®‰è£… Docker Compose

```bash
# ä¸‹è½½ Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" \
    -o /usr/local/bin/docker-compose

# æ·»åŠ æ‰§è¡Œæƒé™
sudo chmod +x /usr/local/bin/docker-compose

# åˆ›å»ºè½¯é“¾æŽ¥
sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose

# éªŒè¯å®‰è£…
docker-compose --version
```

### 2.3 é…ç½® Docker ç½‘ç»œ

```bash
# åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ
docker network create hmall

# éªŒè¯ç½‘ç»œ
docker network ls | grep hmall
```

---

## 3. åŸºç¡€æœåŠ¡éƒ¨ç½²

### 3.1 åˆ›å»º Docker Compose é…ç½®

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > /opt/docker/docker-compose.yml << 'EOF'
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    container_name: mysql
    restart: unless-stopped
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: "Qiu#CHINHAE#"
    volumes:
      - /opt/docker/mysql/data:/var/lib/mysql
      - /opt/docker/mysql/conf:/etc/mysql/conf.d
      - /opt/docker/mysql/logs:/logs
    networks:
      - hmall

  redis:
    image: redis:latest
    container_name: redis
    restart: unless-stopped
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
      - /opt/docker/redis/conf:/usr/local/etc/redis
    command: redis-server /usr/local/etc/redis/redis.conf
    networks:
      - hmall

  rabbitmq:
    image: rabbitmq:management
    container_name: rabbitmq
    restart: unless-stopped
    ports:
      - "5672:5672"
      - "15672:15672"
    environment:
      RABBITMQ_DEFAULT_USER: "admin"
      RABBITMQ_DEFAULT_PASS: "Qiu@CHINHAE!"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq
      - rabbitmq_conf:/etc/rabbitmq
    networks:
      - hmall

  nginx:
    image: nginx:latest
    container_name: nginx
    restart: unless-stopped
    ports:
      - "80:80"
      - "18080:18080"
      - "18081:18081"
    volumes:
      - /opt/docker/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:ro
      - /opt/docker/nginx/logs:/var/log/nginx
      - /opt/financing-projects/ruoyi/frontend/dist:/usr/share/nginx/html:ro
    networks:
      - hmall

  sentinel:
    image: bladex/sentinel-dashboard:1.8.6
    container_name: sentinel
    restart: always
    ports:
      - "8858:8858"
    environment:
      - JAVA_OPTS=-Dsentinel.dashboard.auth.username=admin -Dsentinel.dashboard.auth.password=Qiu@CHINHAE!
    volumes:
      - /opt/docker/data:/root/logs/csp
      - /opt/docker/logs:/opt/sentinel-dashboard/logs
    networks:
      - sentinel-net

networks:
  hmall:
    name: hmall
    driver: bridge
  sentinel-net:
    driver: bridge

volumes:
  redis_data:
  rabbitmq_data:
  rabbitmq_conf:
EOF
```

### 3.2 é…ç½® MySQL

```bash
# åˆ›å»º MySQL é…ç½®ç›®å½•
mkdir -p /opt/docker/mysql/{data,conf,logs}

# åˆ›å»º MySQL é…ç½®æ–‡ä»¶
cat > /opt/docker/mysql/conf/my.cnf << 'EOF'
[mysqld]
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci
default-time-zone='+8:00'
max_connections=1000
max_allowed_packet=64M

[client]
default-character-set=utf8mb4
EOF
```

### 3.3 é…ç½® Redis

```bash
# åˆ›å»º Redis é…ç½®ç›®å½•
mkdir -p /opt/docker/redis/conf

# åˆ›å»º Redis é…ç½®æ–‡ä»¶
cat > /opt/docker/redis/conf/redis.conf << 'EOF'
bind 0.0.0.0
protected-mode yes
port 6379
requirepass Qiu@CHINHAE!
maxmemory 512mb
maxmemory-policy allkeys-lru
appendonly yes
appendfilename "appendonly.aof"
EOF
```

### 3.4 å¯åŠ¨åŸºç¡€æœåŠ¡

```bash
# è¿›å…¥ Docker ç›®å½•
cd /opt/docker

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 3.5 åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿žæŽ¥ MySQL
docker exec -it mysql mysql -uroot -p'Qiu#CHINHAE#'

# åˆ›å»ºæ•°æ®åº“
CREATE DATABASE IF NOT EXISTS financing DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# é€€å‡º
exit;

# å¯¼å…¥æ•°æ®åº“è„šæœ¬ï¼ˆå¦‚æžœæœ‰ï¼‰
docker exec -i mysql mysql -uroot -p'Qiu#CHINHAE#' financing < /path/to/financing.sql
```

---

## 4. Java åŽç«¯éƒ¨ç½²

### 4.1 ä¸Šä¼ é¡¹ç›®ä»£ç 

```bash
# åˆ›å»ºåŽç«¯ç›®å½•
mkdir -p /opt/financing-projects/ruoyi/backend

# ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨ï¼ˆæœ¬åœ°æ‰§è¡Œï¼‰
scp -r /path/to/ruoyi-backend root@your-server-ip:/opt/financing-projects/ruoyi/backend/

# æˆ–ä½¿ç”¨ Git å…‹éš†
cd /opt/financing-projects/ruoyi
git clone your-git-repository backend
```

### 4.2 é…ç½® application.yml

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim /opt/financing-projects/ruoyi/backend/ruoyi-admin/src/main/resources/application.yml

# ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š
# 1. æ•°æ®åº“è¿žæŽ¥
spring:
  datasource:
    url: jdbc:mysql://172.17.0.1:3306/financing?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8
    username: root
    password: Qiu#CHINHAE#

# 2. Redis è¿žæŽ¥
  redis:
    host: 172.17.0.1
    port: 6379
    password: Qiu@CHINHAE!

# 3. RabbitMQ è¿žæŽ¥
  rabbitmq:
    host: 172.17.0.1
    port: 5672
    username: admin
    password: Qiu@CHINHAE!
```

### 4.3 Maven æ‰“åŒ…

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/financing-projects/ruoyi/backend

# æ¸…ç†å¹¶æ‰“åŒ…ï¼ˆè·³è¿‡æµ‹è¯•ï¼‰
mvn clean package -DskipTests

# æ‰“åŒ…å®ŒæˆåŽï¼Œjar åŒ…ä½ç½®ï¼š
# /opt/financing-projects/ruoyi/backend/ruoyi-admin/target/ruoyi-admin.jar
```

### 4.4 åˆ›å»ºå¯åŠ¨è„šæœ¬

```bash
# åˆ›å»ºå¯åŠ¨è„šæœ¬
cat > /opt/financing-projects/ruoyi/backend/start.sh << 'EOF'
#!/bin/bash

APP_NAME=ruoyi-admin.jar
APP_PATH=/opt/financing-projects/ruoyi/backend/ruoyi-admin/target
LOG_PATH=/opt/financing-projects/ruoyi/backend/logs

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p $LOG_PATH

# åœæ­¢æ—§è¿›ç¨‹
PID=$(ps -ef | grep $APP_NAME | grep -v grep | awk '{print $2}')
if [ -n "$PID" ]; then
    echo "åœæ­¢æ—§è¿›ç¨‹: $PID"
    kill -9 $PID
fi

# å¯åŠ¨æ–°è¿›ç¨‹
nohup java -jar $APP_PATH/$APP_NAME \
    --spring.profiles.active=prod \
    > $LOG_PATH/app.log 2>&1 &

echo "åº”ç”¨å¯åŠ¨æˆåŠŸï¼ŒPID: $!"
echo "æ—¥å¿—æ–‡ä»¶: $LOG_PATH/app.log"
EOF

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x /opt/financing-projects/ruoyi/backend/start.sh
```

### 4.5 å¯åŠ¨ Java åŽç«¯

```bash
# å¯åŠ¨æœåŠ¡
/opt/financing-projects/ruoyi/backend/start.sh

# æŸ¥çœ‹æ—¥å¿—
tail -f /opt/financing-projects/ruoyi/backend/logs/app.log

# æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨
netstat -tlnp | grep 8080
```

### 4.6 é…ç½®å¼€æœºè‡ªå¯ï¼ˆå¯é€‰ï¼‰

```bash
# åˆ›å»º systemd æœåŠ¡æ–‡ä»¶
sudo cat > /etc/systemd/system/ruoyi-backend.service << 'EOF'
[Unit]
Description=RuoYi Backend Service
After=network.target mysql.service redis.service

[Service]
Type=forking
User=root
WorkingDirectory=/opt/financing-projects/ruoyi/backend
ExecStart=/opt/financing-projects/ruoyi/backend/start.sh
ExecStop=/bin/kill -9 $(ps -ef | grep ruoyi-admin.jar | grep -v grep | awk '{print $2}')
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# é‡è½½ systemd
sudo systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
sudo systemctl start ruoyi-backend

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable ruoyi-backend

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status ruoyi-backend
```

---

## 5. Python çˆ¬è™«æœåŠ¡éƒ¨ç½²

### 5.1 ä¸Šä¼ é¡¹ç›®ä»£ç 

```bash
# åˆ›å»º Python é¡¹ç›®ç›®å½•
mkdir -p /opt/financing-projects/ruoyi/python

# ä¸Šä¼ ä»£ç ï¼ˆæœ¬åœ°æ‰§è¡Œï¼‰
scp -r /path/to/financial-crawler-service root@your-server-ip:/opt/financing-projects/ruoyi/python/

# æˆ–ä½¿ç”¨ Git
cd /opt/financing-projects/ruoyi/python
git clone your-python-repository financial-crawler-service
```

### 5.2 åˆ›å»º Python è™šæ‹ŸçŽ¯å¢ƒ

```bash
# åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒç›®å½•
mkdir -p /opt/financing-projects/python-env

# åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ
python3.9 -m venv /opt/financing-projects/python-env/ruoyi-python-env

# æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ
source /opt/financing-projects/python-env/ruoyi-python-env/bin/activate

# å‡çº§ pip
pip install --upgrade pip
```

### 5.3 å®‰è£… Python ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /opt/financing-projects/ruoyi/python/financial-crawler-service

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¦‚æžœæ²¡æœ‰ requirements.txtï¼Œæ‰‹åŠ¨å®‰è£…æ ¸å¿ƒä¾èµ–
pip install fastapi uvicorn celery redis pymysql sqlalchemy \
    requests beautifulsoup4 lxml pandas numpy \
    python-dotenv loguru pydantic oss2 wordcloud jieba
```

### 5.4 é…ç½®çŽ¯å¢ƒå˜é‡

```bash
# åˆ›å»º .env é…ç½®æ–‡ä»¶
cat > /opt/financing-projects/ruoyi/python/financial-crawler-service/.env << 'EOF'
# TinyShareé…ç½®ï¼ˆTushareå¢žå¼ºç‰ˆï¼‰
TUSHARE_TOKEN=your_tushare_token_here

# é˜¿é‡Œäº‘OSSé…ç½®ï¼ˆè¯äº‘å›¾ç‰‡å­˜å‚¨ï¼‰
OSS_ACCESS_KEY_ID=your_access_key_id
OSS_ACCESS_KEY_SECRET=your_access_key_secret
OSS_ENDPOINT=oss-cn-chengdu.aliyuncs.com
OSS_BUCKET_NAME=financial-data-analysis
OSS_CDN_DOMAIN=

# æ•°æ®åº“é…ç½®
MYSQL_HOST=172.17.0.1
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=Qiu#CHINHAE#
MYSQL_DATABASE=financing

# Redisé…ç½®
REDIS_HOST=172.17.0.1
REDIS_PORT=6379
REDIS_PASSWORD=Qiu@CHINHAE!
REDIS_DB=0

# RabbitMQé…ç½®ï¼ˆCeleryæ¶ˆæ¯é˜Ÿåˆ—ï¼‰
RABBITMQ_HOST=172.17.0.1
RABBITMQ_PORT=5672
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=Qiu@CHINHAE!
RABBITMQ_VHOST=/

# Celeryé…ç½®
CELERY_BROKER_URL=amqp://admin:Qiu@CHINHAE!@172.17.0.1:5672//
CELERY_RESULT_BACKEND=redis://:Qiu@CHINHAE!@172.17.0.1:6379/1
EOF
```

### 5.5 åˆ›å»º Flask API æœåŠ¡

```bash
# åˆ›å»º systemd æœåŠ¡æ–‡ä»¶
sudo cat > /etc/systemd/system/financial-crawler.service << 'EOF'
[Unit]
Description=Financial Crawler Service
After=network.target mysql.service redis.service

[Service]
Type=simple
User=root
WorkingDirectory=/opt/financing-projects/ruoyi/python/financial-crawler-service
Environment="PATH=/opt/financing-projects/python-env/ruoyi-python-env/bin"
ExecStart=/opt/financing-projects/python-env/ruoyi-python-env/bin/python3 app/main.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF
```

### 5.6 åˆ›å»º Celery Worker æœåŠ¡

```bash
# åˆ›å»º systemd æœåŠ¡æ–‡ä»¶
sudo cat > /etc/systemd/system/financial-celery.service << 'EOF'
[Unit]
Description=Financial Crawler Celery Worker
After=network.target redis.service rabbitmq.service

[Service]
Type=simple
User=root
WorkingDirectory=/opt/financing-projects/ruoyi/python/financial-crawler-service
Environment="PATH=/opt/financing-projects/python-env/ruoyi-python-env/bin"
ExecStart=/opt/financing-projects/python-env/ruoyi-python-env/bin/celery -A app.tasks.celery_app worker --loglevel=info --pool=solo
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF
```

### 5.7 å¯åŠ¨ Python æœåŠ¡

```bash
# é‡è½½ systemd
sudo systemctl daemon-reload

# å¯åŠ¨ Flask API æœåŠ¡
sudo systemctl start financial-crawler.service
sudo systemctl enable financial-crawler.service

# å¯åŠ¨ Celery Worker æœåŠ¡
sudo systemctl start financial-celery.service
sudo systemctl enable financial-celery.service

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status financial-crawler.service
sudo systemctl status financial-celery.service

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u financial-crawler.service -f
sudo journalctl -u financial-celery.service -f
```

---

## 6. å‰ç«¯éƒ¨ç½²

### 6.1 æœ¬åœ°æž„å»ºå‰ç«¯

```bash
# åœ¨æœ¬åœ°å¼€å‘æœºå™¨ä¸Šæ‰§è¡Œ

# è¿›å…¥å‰ç«¯é¡¹ç›®ç›®å½•
cd /path/to/ruoyi-ui

# å®‰è£…ä¾èµ–
npm install

# ä¿®æ”¹ API åœ°å€ï¼ˆå¦‚æžœéœ€è¦ï¼‰
# ç¼–è¾‘ .env.production æ–‡ä»¶
VUE_APP_BASE_API = '/prod-api'

# æž„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build:prod

# æž„å»ºå®ŒæˆåŽï¼Œdist ç›®å½•åŒ…å«æ‰€æœ‰é™æ€æ–‡ä»¶
```

### 6.2 ä¸Šä¼ å‰ç«¯æ–‡ä»¶

```bash
# åˆ›å»ºå‰ç«¯ç›®å½•
mkdir -p /opt/financing-projects/ruoyi/frontend/dist

# ä¸Šä¼  dist ç›®å½•åˆ°æœåŠ¡å™¨ï¼ˆæœ¬åœ°æ‰§è¡Œï¼‰
scp -r /path/to/ruoyi-ui/dist/* root@your-server-ip:/opt/financing-projects/ruoyi/frontend/dist/

# æˆ–ä½¿ç”¨ rsync
rsync -avz --progress /path/to/ruoyi-ui/dist/ root@your-server-ip:/opt/financing-projects/ruoyi/frontend/dist/
```

### 6.3 éªŒè¯å‰ç«¯æ–‡ä»¶

```bash
# æŸ¥çœ‹å‰ç«¯æ–‡ä»¶
ls -lh /opt/financing-projects/ruoyi/frontend/dist/

# åº”è¯¥åŒ…å«ï¼š
# - index.html
# - favicon.ico
# - static/ ç›®å½•
```

---

## 7. Nginx åå‘ä»£ç†é…ç½®

### 7.1 åˆ›å»º Nginx é…ç½®

```bash
# åˆ›å»º Nginx é…ç½®ç›®å½•
mkdir -p /opt/docker/nginx/conf
mkdir -p /opt/docker/nginx/logs

# åˆ›å»º Nginx é…ç½®æ–‡ä»¶
cat > /opt/docker/nginx/conf/nginx.conf << 'EOF'
user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log notice;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    tcp_nopush      on;
    tcp_nodelay     on;
    keepalive_timeout  65;
    types_hash_max_size 2048;
    client_max_body_size 100M;

    gzip  on;
    gzip_vary on;
    gzip_min_length 1k;
    gzip_comp_level 6;
    gzip_types text/plain text/css text/xml text/javascript 
               application/json application/javascript application/xml+rss 
               application/rss+xml font/truetype font/opentype 
               application/vnd.ms-fontobject image/svg+xml;

    # å‰ç«¯æœåŠ¡å™¨é…ç½®
    server {
        listen       80;
        server_name  _;
      
        # å‰ç«¯é™æ€æ–‡ä»¶
        location / {
            root   /usr/share/nginx/html;
            index  index.html index.htm;
            try_files $uri $uri/ /index.html;
          
            # ç¦ç”¨ç¼“å­˜ï¼ˆå¼€å‘çŽ¯å¢ƒï¼‰
            add_header Cache-Control "no-cache, must-revalidate";
          
            # ç”Ÿäº§çŽ¯å¢ƒå»ºè®®å¯ç”¨ç¼“å­˜
            # expires 7d;
            # add_header Cache-Control "public, immutable";
        }

        # Java åŽç«¯ API ä»£ç†
        location /prod-api/ {
            proxy_pass http://172.17.0.1:8080/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_connect_timeout 600;
            proxy_read_timeout 600;
            proxy_send_timeout 600;
        }

        # Python çˆ¬è™«æœåŠ¡ API ä»£ç†
        location /api/financial/ {
            proxy_pass http://172.17.0.1:5001/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_connect_timeout 600;
            proxy_read_timeout 600;
            proxy_send_timeout 600;
        }

        # é”™è¯¯é¡µé¢
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }

        # å®‰å…¨é…ç½®ï¼šç¦æ­¢è®¿é—®éšè—æ–‡ä»¶
        location ~ /\. {
            deny all;
            access_log off;
            log_not_found off;
        }
    }
}
EOF
```

### 7.2 é‡å¯ Nginx

```bash
# è¿›å…¥ Docker ç›®å½•
cd /opt/docker

# é‡å¯ Nginx å®¹å™¨
docker-compose restart nginx

# æµ‹è¯• Nginx é…ç½®
docker exec nginx nginx -t

# æŸ¥çœ‹ Nginx æ—¥å¿—
docker logs --tail 50 nginx
```

### 7.3 é…ç½®é˜²ç«å¢™

```bash
# å¼€æ”¾ 80 ç«¯å£
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --reload

# æŸ¥çœ‹å·²å¼€æ”¾ç«¯å£
sudo firewall-cmd --list-ports

# å¦‚æžœä½¿ç”¨äº‘æœåŠ¡å™¨ï¼Œè¿˜éœ€è¦åœ¨äº‘æŽ§åˆ¶å°é…ç½®å®‰å…¨ç»„
# å¼€æ”¾å…¥ç«™è§„åˆ™ï¼šTCP 80 ç«¯å£
```

---

## 8. æœåŠ¡ç®¡ç†ä¸Žç›‘æŽ§

### 8.1 æœåŠ¡çŠ¶æ€æ£€æŸ¥

```bash
# æ£€æŸ¥æ‰€æœ‰ Docker æœåŠ¡
docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"

# æ£€æŸ¥ Java åŽç«¯
netstat -tlnp | grep 8080
ps -ef | grep ruoyi-admin.jar

# æ£€æŸ¥ Python æœåŠ¡
sudo systemctl status financial-crawler.service
sudo systemctl status financial-celery.service

# æµ‹è¯•æœåŠ¡å¥åº·æ£€æŸ¥
curl http://localhost/api/financial/health
curl http://localhost/prod-api/
```

### 8.2 æŸ¥çœ‹æ—¥å¿—

```bash
# Docker æœåŠ¡æ—¥å¿—
docker-compose logs -f nginx
docker-compose logs -f mysql
docker-compose logs -f redis

# Java åŽç«¯æ—¥å¿—
tail -f /opt/financing-projects/ruoyi/backend/logs/app.log

# Python æœåŠ¡æ—¥å¿—
sudo journalctl -u financial-crawler.service -f
sudo journalctl -u financial-celery.service -f

# Nginx æ—¥å¿—
tail -f /opt/docker/nginx/logs/access.log
tail -f /opt/docker/nginx/logs/error.log
```

### 8.3 æœåŠ¡é‡å¯

```bash
# é‡å¯ Docker æœåŠ¡
cd /opt/docker
docker-compose restart

# é‡å¯ Java åŽç«¯
sudo systemctl restart ruoyi-backend

# é‡å¯ Python æœåŠ¡
sudo systemctl restart financial-crawler.service
sudo systemctl restart financial-celery.service

# é‡å¯ Nginx
docker-compose restart nginx
```

### 8.4 æœåŠ¡åœæ­¢

```bash
# åœæ­¢æ‰€æœ‰ Docker æœåŠ¡
cd /opt/docker
docker-compose stop

# åœæ­¢ Java åŽç«¯
sudo systemctl stop ruoyi-backend

# åœæ­¢ Python æœåŠ¡
sudo systemctl stop financial-crawler.service
sudo systemctl stop financial-celery.service
```

---

## 9. å¸¸è§é—®é¢˜æŽ’æŸ¥

### 9.1 å‰ç«¯æ— æ³•è®¿é—®

```bash
# 1. æ£€æŸ¥ Nginx æ˜¯å¦è¿è¡Œ
docker ps | grep nginx

# 2. æ£€æŸ¥å‰ç«¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -lh /opt/financing-projects/ruoyi/frontend/dist/

# 3. æ£€æŸ¥ Nginx é…ç½®
docker exec nginx nginx -t

# 4. æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
tail -50 /opt/docker/nginx/logs/error.log

# 5. æµ‹è¯•æœ¬åœ°è®¿é—®
curl -I http://localhost/
```

### 9.2 Java åŽç«¯è¿žæŽ¥å¤±è´¥

```bash
# 1. æ£€æŸ¥ Java è¿›ç¨‹æ˜¯å¦è¿è¡Œ
ps -ef | grep ruoyi-admin.jar

# 2. æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tlnp | grep 8080

# 3. æŸ¥çœ‹ Java æ—¥å¿—
tail -100 /opt/financing-projects/ruoyi/backend/logs/app.log

# 4. æ£€æŸ¥æ•°æ®åº“è¿žæŽ¥
docker exec -it mysql mysql -uroot -p'Qiu#CHINHAE#' -e "SELECT 1;"

# 5. æµ‹è¯• API è®¿é—®
curl http://localhost:8080/
```

### 9.3 Python æœåŠ¡æŠ¥é”™

```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status financial-crawler.service
sudo systemctl status financial-celery.service

# 2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo journalctl -u financial-crawler.service -n 100 --no-pager
sudo journalctl -u financial-celery.service -n 100 --no-pager

# 3. æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 5001

# 4. æ£€æŸ¥æ•°æ®åº“é…ç½®
cat /opt/financing-projects/ruoyi/python/financial-crawler-service/.env | grep MYSQL

# 5. æ‰‹åŠ¨æµ‹è¯•å¯åŠ¨
cd /opt/financing-projects/ruoyi/python/financial-crawler-service
source /opt/financing-projects/python-env/ruoyi-python-env/bin/activate
python3 app/main.py
```

### 9.4 æ•°æ®åº“è¿žæŽ¥å¤±è´¥

```bash
# 1. æ£€æŸ¥ MySQL å®¹å™¨çŠ¶æ€
docker ps | grep mysql

# 2. æŸ¥çœ‹ MySQL æ—¥å¿—
docker logs --tail 50 mysql

# 3. æµ‹è¯•æ•°æ®åº“è¿žæŽ¥
docker exec -it mysql mysql -uroot -p'Qiu#CHINHAE#'

# 4. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨
docker exec -it mysql mysql -uroot -p'Qiu#CHINHAE#' -e "SHOW DATABASES;"

# 5. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
ping 172.17.0.1
telnet 172.17.0.1 3306
```

### 9.5 Redis è¿žæŽ¥å¤±è´¥

```bash
# 1. æ£€æŸ¥ Redis å®¹å™¨çŠ¶æ€
docker ps | grep redis

# 2. æŸ¥çœ‹ Redis æ—¥å¿—
docker logs --tail 50 redis

# 3. æµ‹è¯• Redis è¿žæŽ¥
docker exec -it redis redis-cli -a 'Qiu@CHINHAE!' ping

# 4. æ£€æŸ¥ Redis é…ç½®
cat /opt/docker/redis/conf/redis.conf
```

### 9.6 Nginx 502 é”™è¯¯

```bash
# 1. æ£€æŸ¥åŽç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ
ps -ef | grep ruoyi-admin.jar
sudo systemctl status financial-crawler.service

# 2. æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tlnp | grep 8080
netstat -tlnp | grep 5001

# 3. æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
tail -50 /opt/docker/nginx/logs/error.log

# 4. æµ‹è¯•åŽç«¯ç›´æŽ¥è®¿é—®
curl http://172.17.0.1:8080/
curl http://172.17.0.1:5001/health

# 5. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
sudo firewall-cmd --list-all
```

---

## 10. è®¿é—®åœ°å€æ±‡æ€»

éƒ¨ç½²å®ŒæˆåŽï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ç³»ç»Ÿï¼š

```
å‰ç«¯é¡µé¢:        http://your-server-ip/
Java åŽç«¯ API:   http://your-server-ip/prod-api/
Python 