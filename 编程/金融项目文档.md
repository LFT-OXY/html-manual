
# 金融数据分析平台 - 产品需求文档 (PRD)

---

## 📌 文档信息

| 项目名称 | 金融数据分析平台 |
|---------|----------------|
| 文档版本 | V1.0 |
| 编写人 | nimbus |
| 创建日期 | 2024 |
| 技术栈 | RuoYi (前后端分离) + Java + Python + MySQL |

---

## 一、项目概述

### 1.1 项目背景
本项目旨在为金融专业的学生和研究人员提供一个集数据采集、处理、分析、可视化于一体的综合性平台。通过整合国泰安、Wind、同花顺等主流金融数据源，实现数据的自动化采集、智能化分析和可视化展示。

### 1.2 项目目标
- 搭建基于 RuoYi 框架的前后端分离系统架构
- 实现多数据源的关键词爬取功能
- 提供数据清洗、处理、分析的完整流程
- 支持多种图表可视化展示
- 实现基于角色的权限管理体系
- 预留问卷功能和词云生成功能的接口

### 1.3 用户角色
- **学生**：使用平台进行数据查询、分析和学习
- **研究人员**：进行深度数据分析和研究
- **管理员**：系统管理、用户管理、权限配置

---

## 二、系统架构设计

### 2.1 技术架构
```
前端层：Vue.js + Element UI (RuoYi 默认)
├── 用户界面
├── 数据可视化
└── 交互逻辑

后端层：
├── Java (Spring Boot + RuoYi)
│   ├── 用户认证与权限管理
│   ├── 业务逻辑处理
│   ├── API 网关
│   └── 数据库操作
│
└── Python 服务
    ├── 数据爬取模块
    ├── 数据处理与分析
    ├── 词云生成
    └── RESTful API 接口

数据层：MySQL 数据库
├── 用户数据
├── 爬取数据
├── 分析结果
└── 系统配置
```

### 2.2 模块划分
1. **用户管理模块** (Java)
2. **数据爬取模块** (Python)
3. **数据处理模块** (Python)
4. **数据可视化模块** (Java + 前端)
5. **词云生成模块** (Python)
6. **问卷管理模块** (Java - 预留)

---

## 三、功能需求详述

---

### 功能模块 1：用户管理与权限控制

#### 功能名
用户认证与角色权限管理系统

#### 需求描述
实现基于 RuoYi 框架的用户登录、注册、角色分配和权限控制功能，确保不同角色用户访问相应的功能模块。

#### 概述
系统需要支持三种用户角色（学生、研究人员、管理员），每种角色具有不同的操作权限。用户必须登录后才能使用系统功能。

#### 相关页面设计
1. **登录页面**
   - 用户名/邮箱输入框
   - 密码输入框
   - 验证码
   - 登录按钮
   - 注册链接

2. **注册页面**
   - 用户名
   - 邮箱
   - 密码
   - 确认密码
   - 角色选择（学生/研究人员）
   - 注册按钮

3. **用户管理页面**（管理员专用）
   - 用户列表（表格展示）
   - 搜索/筛选功能
   - 用户状态管理（启用/禁用）
   - 角色分配
   - 删除用户

#### 用户旅程
1. 新用户访问系统 → 点击注册 → 填写信息 → 选择角色 → 提交注册
2. 已注册用户 → 输入账号密码 → 验证码验证 → 登录成功 → 进入主界面
3. 管理员登录 → 进入用户管理 → 查看用户列表 → 分配角色/管理权限

#### 用户故事
- 作为**学生**，我希望能够注册账号并登录系统，以便使用数据查询和分析功能
- 作为**研究人员**，我希望拥有更高的数据访问权限，以便进行深度研究
- 作为**管理员**，我希望能够管理所有用户账号和权限，以便维护系统安全

#### 实现逻辑
1. 使用 RuoYi 框架内置的 Spring Security 进行认证
2. 基于 RBAC (角色访问控制) 模型设计权限体系
3. 用户信息存储在 MySQL 的 `sys_user` 表
4. 角色信息存储在 `sys_role` 表
5. 权限信息存储在 `sys_menu` 表
6. JWT Token 用于维持登录状态

#### 功能细节描述
- **权限级别**：
  - 学生：只读权限，可查询和分析数据
  - 研究人员：读写权限，可保存分析结果
  - 管理员：全部权限，可管理用户和系统配置

- **安全措施**：
  - 密码 BCrypt 加密存储
  - 登录失败 5 次锁定账号 30 分钟
  - Token 有效期 2 小时，支持刷新

---

### 功能模块 2：数据爬取功能

#### 功能名
多数据源关键词爬取系统

#### 需求描述
用户输入关键词后，系统从国泰安、Wind、同花顺等数据源爬取相关数据、标题、文章等信息，并存储到数据库。

#### 概述
本功能使用 Python 实现爬虫逻辑，通过 RESTful API 与 Java 后端交互。支持用户自定义关键词，异步爬取数据，并提供爬取进度反馈。

#### 相关页面设计
1. **数据爬取页面**
   - 关键词输入框（支持多个关键词，逗号分隔）
   - 数据源选择（多选框）：
     - ☑ 国泰安
     - ☑ Wind
     - ☑ 同花顺
   - 时间范围选择器（起始日期 - 结束日期）
   - 开始爬取按钮
   - 爬取进度条
   - 爬取日志显示区域

2. **爬取历史页面**
   - 历史爬取任务列表
   - 任务状态（进行中/已完成/失败）
   - 查看详情按钮
   - 删除任务按钮

#### 用户旅程
1. 用户登录系统 → 进入数据爬取页面
2. 输入关键词（如"新能源汽车"）
3. 选择数据源（勾选国泰安、Wind）
4. 选择时间范围（2023-01-01 至 2024-01-01）
5. 点击"开始爬取"按钮
6. 系统显示进度条和实时日志
7. 爬取完成后提示成功，数据存入数据库
8. 用户可在"爬取历史"中查看本次任务详情

#### 用户故事
- 作为**研究人员**，我希望能够输入关键词并选择多个数据源进行爬取，以便获取全面的数据进行分析
- 作为**学生**，我希望看到爬取进度和日志，以便了解数据采集的实时状态

#### 实现逻辑
```
前端 (Vue)
  ↓ 提交爬取请求
Java 后端 (RuoYi)
  ↓ 调用 Python API
Python 爬虫服务
  ↓ 执行爬取任务
  ├─ 国泰安爬虫
  ├─ Wind 爬虫
  └─ 同花顺爬虫
  ↓ 返回爬取结果
Java 后端
  ↓ 存储到 MySQL
数据库 (crawl_data 表)
```

**Python 爬虫服务 API 设计**：
- `POST /api/crawler/start` - 启动爬取任务
- `GET /api/crawler/status/{task_id}` - 查询任务状态
- `GET /api/crawler/result/{task_id}` - 获取爬取结果

#### 功能细节描述

**数据库表设计 - crawl_task（爬取任务表）**
```sql
CREATE TABLE crawl_task (
    task_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    keywords VARCHAR(500),
    data_sources VARCHAR(200),
    start_date DATE,
    end_date DATE,
    status VARCHAR(20), -- pending/running/completed/failed
    progress INT DEFAULT 0,
    create_time DATETIME,
    update_time DATETIME
);
```

**数据库表设计 - crawl_data（爬取数据表）**
```sql
CREATE TABLE crawl_data (
    data_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    task_id BIGINT,
    data_source VARCHAR(50),
    title VARCHAR(500),
    content TEXT,
    publish_date DATE,
    url VARCHAR(500),
    keywords VARCHAR(200),
    create_time DATETIME
);
```

**爬虫技术选型**：
- 使用 `requests` + `BeautifulSoup` 或 `Scrapy` 框架
- 使用 `Selenium` 处理动态加载页面
- 实现反爬虫策略（User-Agent 轮换、代理 IP、请求延迟）

**异步处理**：
- 使用 Celery 实现异步任务队列
- Redis 作为消息队列中间件
- 支持任务进度实时推送（WebSocket）

---

### 功能模块 3：数据处理与分析

#### 功能名
数据清洗与变量计算系统

#### 需求描述
对爬取的原始数据进行清洗、去重、补齐、排序等预处理，并通过相关运算生成新的变量，支持用户自定义变量命名。

#### 概述
本功能使用 Python (Pandas) 实现数据处理逻辑，提供可视化的数据处理流程配置界面，支持数据预览和处理结果导出。

#### 相关页面设计
1. **数据处理页面**
   - 数据源选择（下拉框，显示已爬取的任务）
   - 数据预览表格（显示前 100 条原始数据）
   - 处理步骤配置区：
     - ☑ 数据清洗（去除空值、异常值）
     - ☑ 去重
     - ☑ 数据补齐（插值方法选择）
     - ☑ 排序（选择排序字段和方式）
   - 变量计算配置：
     - 添加计算规则按钮
     - 公式输入框（如：`新变量 = 字段A * 字段B / 100`）
     - 变量命名输入框
   - 执行处理按钮
   - 处理后数据预览
   - 导出按钮（CSV/Excel）

#### 用户旅程
1. 用户进入数据处理页面
2. 从下拉框选择已爬取的数据任务
3. 系统加载并预览原始数据
4. 用户勾选需要的处理步骤（清洗、去重、补齐、排序）
5. 用户添加变量计算规则：
   - 输入公式：`收益率 = (收盘价 - 开盘价) / 开盘价 * 100`
   - 命名新变量：`daily_return`
6. 点击"执行处理"
7. 系统调用 Python 服务进行数据处理
8. 显示处理后的数据预览
9. 用户确认无误后点击"保存"或"导出"

#### 用户故事
- 作为**研究人员**，我希望能够对爬取的数据进行清洗和去重，以便获得高质量的分析数据
- 作为**学生**，我希望能够通过简单的公式配置生成新的变量，以便进行金融指标计算

#### 实现逻辑
```python
# Python 数据处理服务伪代码
def process_data(task_id, config):
    # 1. 从数据库读取原始数据
    df = load_data_from_db(task_id)
  
    # 2. 数据清洗
    if config['clean']:
        df = df.dropna()  # 去除空值
        df = remove_outliers(df)  # 去除异常值
  
    # 3. 去重
    if config['deduplicate']:
        df = df.drop_duplicates()
  
    # 4. 数据补齐
    if config['fill']:
        df = df.fillna(method=config['fill_method'])
  
    # 5. 排序
    if config['sort']:
        df = df.sort_values(by=config['sort_field'])
  
    # 6. 变量计算
    for rule in config['calc_rules']:
        df[rule['new_var']] = eval(rule['formula'])
  
    # 7. 保存处理后的数据
    save_processed_data(df, task_id)
  
    return df
```

**Java 后端 API**：
- `POST /api/data/process` - 提交数据处理任务
- `GET /api/data/preview/{task_id}` - 预览原始数据
- `GET /api/data/result/{task_id}` - 获取处理结果
- `GET /api/data/export/{task_id}` - 导出数据

#### 功能细节描述

**数据库表设计 - processed_data（处理后数据表）**
```sql
CREATE TABLE processed_data (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    task_id BIGINT,
    data_json TEXT, -- 存储处理后的数据（JSON 格式）
    process_config TEXT, -- 处理配置
    create_time DATETIME
);
```

**数据清洗规则**：
- 去除空值：删除关键字段为空的记录
- 异常值处理：使用 3σ 原则或 IQR 方法
- 数据类型转换：确保数值字段为正确类型

**数据补齐方法**：
- 前向填充 (ffill)
- 后向填充 (bfill)
- 线性插值 (interpolate)
- 均值填充

**变量计算支持**：
- 基本运算：+、-、*、/
- 数学函数：log、exp、sqrt
- 条件判断：if-else 表达式
- 引用已有字段

---

### 功能模块 4：数据可视化

#### 功能名
多维度图表生成系统

#### 需求描述
基于处理后的数据生成折线图、柱状图、饼图等多种图表，支持用户自定义图表参数和交互式操作。

#### 概述
使用前端图表库（ECharts）实现数据可视化，Java 后端提供数据接口，支持图表配置保存和导出。

#### 相关页面设计
1. **图表生成页面**
   - 数据源选择（已处理的数据任务）
   - 图表类型选择：
     - 📈 折线图
     - 📊 柱状图
     - 🥧 饼图
   - 参数配置区：
     - X 轴字段选择
     - Y 轴字段选择（支持多选）
     - 图表标题输入
     - 颜色主题选择
   - 图表预览区（实时渲染）
   - 保存配置按钮
   - 导出图片按钮

2. **图表管理页面**
   - 已保存的图表列表（卡片展示）
   - 查看/编辑/删除操作
   - 图表分享功能

#### 用户旅程
1. 用户进入图表生成页面
2. 选择已处理的数据源
3. 选择图表类型（如折线图）
4. 配置参数：
   - X 轴：日期
   - Y 轴：收盘价、成交量
   - 标题：某股票价格走势图
5. 系统实时渲染图表预览
6. 用户调整参数直到满意
7. 点击"保存配置"
8. 可选择导出为 PNG 图片

#### 用户故事
- 作为**研究人员**，我希望能够快速生成多种类型的图表，以便直观展示数据分析结果
- 作为**学生**，我希望能够保存和分享我的图表配置，以便在报告中使用

#### 实现逻辑
```javascript
// 前端 ECharts 配置示例
const option = {
    title: { text: chartConfig.title },
    xAxis: { 
        type: 'category',
        data: chartData.xAxisData 
    },
    yAxis: { type: 'value' },
    series: chartConfig.yFields.map(field => ({
        name: field,
        type: chartConfig.type, // line/bar/pie
        data: chartData[field]
    }))
};
myChart.setOption(option);
```

**Java 后端 API**：
- `GET /api/chart/data/{task_id}` - 获取图表数据
- `POST /api/chart/save` - 保存图表配置
- `GET /api/chart/list` - 获取用户的图表列表
- `DELETE /api/chart/{chart_id}` - 删除图表

#### 功能细节描述

**数据库表设计 - chart_config（图表配置表）**
```sql
CREATE TABLE chart_config (
    chart_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT,
    task_id BIGINT,
    chart_type VARCHAR(20), -- line/bar/pie
    chart_title VARCHAR(200),
    x_field VARCHAR(100),
    y_fields VARCHAR(500), -- JSON 数组
    config_json TEXT, -- 完整配置
    create_time DATETIME
);
```

**图表类型说明**：
1. **折线图**：适用于时间序列数据，展示趋势变化
2. **柱状图**：适用于分类数据对比
3. **饼图**：适用于占比分析

**交互功能**：
- 图表缩放（dataZoom）
- 数据点悬停提示（tooltip）
- 图例切换
- 数据导出（CSV/Excel）

**图表导出**：
- 使用 ECharts 的 `getDataURL()` 方法导出 PNG
- 支持自定义分辨率

---

### 功能模块 5：词云生成

#### 功能名
高频关键词词云可视化

#### 需求描述
基于爬取的文本数据，统计高频关键词并生成词云图，支持自定义词云样式和停用词过滤。

#### 概述
使用 Python (wordcloud + jieba) 实现中文分词和词云生成，提供可视化配置界面。

#### 相关页面设计
1. **词云生成页面**
   - 数据源选择（爬取任务）
   - 文本字段选择（标题/内容）
   - 停用词配置：
     - 使用默认停用词库
     - 自定义停用词（文本框输入）
   - 词云样式配置：
     - 最大词数（滑块：10-200）
     - 颜色方案（下拉选择）
     - 背景颜色
     - 词云形状（矩形/圆形/自定义图片）
   - 生成按钮
   - 词云预览区
   - 下载词云图片按钮
   - 词频统计表格（Top 50）

#### 用户旅程
1. 用户进入词云生成页面
2. 选择数据源（如"新能源汽车"爬取任务）
3. 选择文本字段（内容）
4. 配置停用词（添加"的、了、是"等）
5. 设置词云样式：
   - 最大词数：100
   - 颜色方案：蓝色系
   - 形状：圆形
6. 点击"生成词云"
7. 系统调用 Python 服务生成词云
8. 显示词云图片和词频统计表
9. 用户下载词云图片

#### 用户故事
- 作为**研究人员**，我希望能够快速生成词云图，以便直观了解文本数据中的热点话题
- 作为**学生**，我希望能够自定义词云样式，以便在论文中使用美观的可视化图表

#### 实现逻辑
```python
# Python 词云生成服务
from wordcloud import WordCloud
import jieba

def generate_wordcloud(task_id, config):
    # 1. 获取文本数据
    texts = get_text_data(task_id, config['text_field'])
  
    # 2. 中文分词
    words = []
    for text in texts:
        words.extend(jieba.cut(text))
  
    # 3. 过滤停用词
    stopwords = load_stopwords(config['stopwords'])
    words = [w for w in words if w not in stopwords]
  
    # 4. 统计词频
    word_freq = Counter(words)
    top_words = word_freq.most_common(config['max_words'])
  
    # 5. 生成词云
    wc = WordCloud(
        font_path='simhei.ttf',
        width=800,
        height=600,
        background_color=config['bg_color'],
        max_words=config['max_words'],
        colormap=config['color_scheme']
    )
    wc.generate_from_frequencies(dict(top_words))
  
    # 6. 保存图片
    image_path = save_wordcloud_image(wc, task_id)
  
    return {
        'image_url': image_path,
        'word_freq': top_words
    }
```

**Python API**：
- `POST /api/wordcloud/generate` - 生成词云
- `GET /api/wordcloud/result/{task_id}` - 获取词云结果

#### 功能细节描述

**数据库表设计 - wordcloud_result（词云结果表）**
```sql
CREATE TABLE wordcloud_result (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    task_id BIGINT,
    image_path VARCHAR(500),
    word_freq_json TEXT, -- 词频统计 JSON
    config_json TEXT,
    create_time DATETIME
);
```

**中文分词**：
- 使用 jieba 分词库
- 支持自定义词典
- 词性过滤（只保留名词、动词等）

**停用词库**：
- 内置中文停用词库（哈工大停用词表）
- 支持用户自定义添加
- 支持正则表达式过滤

**词云样式**：
- 颜色方案：10+ 预设配色
- 支持上传自定义形状图片（mask）
- 字体大小根据词频自动调整

---

### 功能模块 6：问卷管理（预留功能）

#### 功能名
自动问卷填写系统（前端展示）

#### 需求描述
在前端预留问卷管理模块入口，暂时只需要展示功能菜单和空白页面，后期补充具体实现。

#### 概述
本阶段只需要在系统菜单中添加"问卷管理"选项，点击后显示"功能开发中"的提示页面。

#### 相关页面设计
1. **问卷管理页面**（占位页面）
   - 页面标题："问卷管理"
   - 中央显示："该功能正在开发中，敬请期待"
   - 预留区域：问卷列表、创建问卷按钮

#### 实现逻辑
- 在 RuoYi 菜单管理中添加"问卷管理"菜单项
- 创建空白 Vue 组件页面
- 配置路由映射

#### 功能细节描述
- 仅需前端页面框架
- 无需后端接口
- 预留数据库表结构设计文档

---

## 四、非功能性需求

### 4.1 性能要求
- 系统响应时间 < 2 秒
- 支持并发用户数：100+
- 数据爬取任务支持异步处理，不阻塞用户操作
- 图表渲染流畅，支持大数据量（10000+ 数据点）

### 4.2 安全要求
- 所有 API 接口需要 Token 认证
- 敏感数据加密存储
- SQL 注入防护
- XSS 攻击防护
- 定期数据备份

### 4.3 可扩展性
- 模块化设计，便于后期功能扩展
- 数据源可配置，易于添加新的数据源
- 图表类型可扩展
- 支持插件化开发

### 4.4 兼容性
- 浏览器支持：Chrome、Firefox、Edge（最新版本）
- 移动端响应式适配（可选）

---

## 五、数据库设计概要

### 核心数据表
1. **sys_user** - 用户表（RuoYi 自带）
2. **sys_role** - 角色表（RuoYi 自带）
3. **sys_menu** - 菜单权限表（RuoYi 自带）
4. **crawl_task** - 爬取任务表
5. **crawl_data** - 爬取数据表
6. **processed_data** - 处理后数据表
7. **chart_config** - 图表配置表
8. **wordcloud_result** - 词云结果表

---

## 六、接口设计概要

### Java 后端接口（Spring Boot）
```
用户管理：
POST   /api/auth/login          - 用户登录
POST   /api/auth/register       - 用户注册
GET    /api/user/info           - 获取用户信息

数据爬取：
POST   /api/crawler/submit      - 提交爬取任务
GET    /api/crawler/list        - 获取任务列表
GET    /api/crawler/detail/{id} - 获取任务详情

数据处理：
POST   /api/data/process        - 提交处理任务
GET    /api/data/preview/{id}   - 预览数据
GET    /api/data/export/{id}    - 导出数据

图表管理：
POST   /api/chart/create        - 创建图表
GET    /api/chart/list          - 获取图表列表
DELETE /api/chart/{id}          - 删除图表
```

### Python 服务接口（Flask/FastAPI）
```
爬虫服务：
POST   /crawler/start           - 启动爬虫
GET    /crawler/status/{id}     - 查询状态

数据处理：
POST   /process/execute         - 执行数据处理
GET    /process/result/{id}     - 获取处理结果

词云生成：
POST   /wordcloud/generate      - 生成词云
GET    /wordcloud/image/{id}    - 获取词云图片
```

## 七、技术实现细节

### 7.1 Java 后端技术栈
```
框架：Spring Boot 2.x + RuoYi
安全：Spring Security + JWT
数据库：MyBatis-Plus + MySQL 8.0
缓存：Redis
日志：Log4j2
API 文档：Swagger/Knife4j
```

### 7.2 Python 服务技术栈
```
Web 框架：Flask 或 FastAPI
爬虫：Scrapy / requests + BeautifulSoup
数据处理：Pandas + NumPy
分词：jieba
词云：wordcloud
异步任务：Celery + Redis
数据库：PyMySQL / SQLAlchemy
```

### 7.3 前端技术栈
```
框架：Vue 2.x / Vue 3.x
UI 库：Element UI / Element Plus
图表：ECharts 5.x
HTTP 客户端：Axios
状态管理：Vuex
路由：Vue Router
```

### 7.4 开发工具
```
IDE：
- Java: IntelliJ IDEA
- Python: PyCharm / VS Code
- 前端: VS Code

版本控制：Git + GitHub/GitLab
接口测试：Postman
数据库管理：Navicat / DBeaver
```

---

## 八、部署架构

### 8.1 开发环境
```
┌─────────────────────────────────────┐
│         开发者本地环境                │
├─────────────────────────────────────┤
│  前端: localhost:8080 (Vue)         │
│  Java 后端: localhost:8081          │
│  Python 服务: localhost:5000        │
│  MySQL: localhost:3306              │
│  Redis: localhost:6379              │
└─────────────────────────────────────┘
```

### 8.2 生产环境（建议）
```
┌──────────────────────────────────────┐
│            Nginx (反向代理)           │
│         Port 80/443 (HTTPS)          │
└────────────┬─────────────────────────┘
             │
    ┌────────┴────────┐
    │                 │
┌───▼────┐      ┌────▼─────┐
│ 前端静态 │      │ API 网关  │
│  资源   │      │  (Java)  │
└────────┘      └────┬─────┘
                     │
          ┌──────────┼──────────┐
          │          │          │
     ┌────▼───┐ ┌───▼────┐ ┌──▼─────┐
     │ Java   │ │ Python │ │ Redis  │
     │ 后端   │ │ 服务   │ │ 缓存   │
     └────┬───┘ └───┬────┘ └────────┘
          │         │
          └────┬────┘
               │
          ┌────▼─────┐
          │  MySQL   │
          │  数据库   │
          └──────────┘
```

---

## 九、风险评估与应对

### 9.1 技术风险

| 风险项 | 风险等级 | 应对措施 |
|--------|---------|---------|
| 数据源反爬虫机制 | 高 | 使用代理 IP 池、模拟浏览器行为、降低爬取频率 |
| 大数据量处理性能 | 中 | 使用分页加载、数据分批处理、增加缓存 |
| Java 与 Python 通信延迟 | 中 | 使用异步调用、优化接口响应时间、增加超时重试 |
| 前端图表渲染卡顿 | 中 | 数据降采样、虚拟滚动、懒加载 |

### 9.2 业务风险

| 风险项 | 风险等级 | 应对措施 |
|--------|---------|---------|
| 数据源访问权限限制 | 高 | 提前确认数据源访问方式，准备备用数据源 |
| 需求变更频繁 | 中 | 采用模块化设计，预留扩展接口 |
| 开发周期紧张 | 中 | 优先实现核心功能，非核心功能后期迭代 |

### 9.3 安全风险

| 风险项 | 风险等级 | 应对措施 |
|--------|---------|---------|
| SQL 注入攻击 | 高 | 使用参数化查询，输入验证 |
| XSS 攻击 | 中 | 前端输入过滤，后端输出转义 |
| 未授权访问 | 高 | 强制 Token 认证，接口权限校验 |
| 敏感数据泄露 | 高 | 密码加密存储，HTTPS 传输 |

---

## 十、项目交付标准

### 10.1 代码质量标准
- ✅ 代码符合阿里巴巴 Java 开发规范
- ✅ Python 代码符合 PEP 8 规范
- ✅ 关键函数必须有注释
- ✅ 单元测试覆盖率 > 60%
- ✅ 无严重 Bug 和安全漏洞

### 10.2 功能完整性
- ✅ 用户管理与权限控制 100% 完成
- ✅ 数据爬取功能 100% 完成
- ✅ 数据处理功能 100% 完成
- ✅ 数据可视化功能 100% 完成
- ✅ 词云生成功能 100% 完成
- ✅ 问卷管理占位页面完成

### 10.3 文档交付
- ✅ 产品需求文档（本文档）
- ✅ 数据库设计文档
- ✅ API 接口文档
- ✅ 部署运维文档
- ✅ 用户操作手册
- ✅ 开发者文档

### 10.4 性能指标
- ✅ 页面加载时间 < 2 秒
- ✅ API 响应时间 < 1 秒
- ✅ 支持 100+ 并发用户
- ✅ 数据库查询优化（索引覆盖率 > 80%）

---

## 十一、后期扩展规划

### 11.1 短期扩展（3 个月内）

2. **数据源扩展**
   - 增加东方财富数据源
   - 增加新浪财经数据源
   - 支持自定义数据源配置

3. **图表类型扩展**
   - 散点图
   - 雷达图
   - K 线图（股票专用）
   - 热力图

### 11.2 中期扩展（6 个月内）
1. **智能分析功能**
   - 基于机器学习的趋势预测
   - 异常数据检测
   - 相关性分析

2. **协作功能**
   - 数据分享
   - 团队协作
   - 评论与讨论

3. **报告生成**
   - 自动生成分析报告（Word/PDF）
   - 报告模板自定义
   - 一键导出

### 11.3 长期扩展（1 年内）
1. **移动端应用**
   - 开发移动端 App（React Native / Flutter）
   - 响应式设计优化

2. **大数据处理**
   - 集成 Spark 进行大数据分析
   - 实时数据流处理

3. **AI 辅助**
   - 集成 GPT 进行智能问答
   - 自动生成分析结论
   - 智能推荐相关数据

---

## 十二、附录

### 12.1 数据库 ER 图（简化版）
```
┌─────────────┐         ┌──────────────┐
│  sys_user   │────────>│  sys_role    │
│  (用户表)    │  多对多  │  (角色表)     │
└─────────────┘         └──────────────┘
       │
       │ 1:N
       ▼
┌─────────────┐         ┌──────────────┐
│ crawl_task  │────────>│ crawl_data   │
│ (爬取任务)   │   1:N   │ (爬取数据)    │
└─────────────┘         └──────────────┘
       │
       │ 1:1
       ▼
┌──────────────┐
│processed_data│
│ (处理后数据)  │
└──────────────┘
       │
       │ 1:N
       ├──────────────┬──────────────┐
       ▼              ▼              ▼
┌─────────────┐ ┌──────────┐ ┌──────────────┐
│chart_config │ │wordcloud │ │questionnaire │
│ (图表配置)   │ │ (词云)   │ │  (问卷)      │
└─────────────┘ └──────────┘ └──────────────┘
```

### 12.2 系统菜单结构
```
金融数据分析平台
├── 首页
├── 数据管理
│   ├── 数据爬取
│   ├── 爬取历史
│   └── 数据处理
├── 数据分析
│   ├── 图表生成
│   ├── 图表管理
│   └── 词云生成
├── 问卷管理（占位）
│   └── 问卷列表
├── 系统管理（管理员）
│   ├── 用户管理
│   ├── 角色管理
│   └── 菜单管理
└── 个人中心
    ├── 个人信息
    └── 修改密码
```

### 12.3 关键 API 接口清单

#### Java 后端接口
```
# 认证授权
POST   /api/auth/login           # 登录
POST   /api/auth/logout          # 登出
POST   /api/auth/register        # 注册
GET    /api/auth/info            # 获取当前用户信息

# 用户管理
GET    /api/user/list            # 用户列表
POST   /api/user/add             # 添加用户
PUT    /api/user/update          # 更新用户
DELETE /api/user/{id}            # 删除用户

# 爬虫任务
POST   /api/crawler/submit       # 提交爬取任务
GET    /api/crawler/list         # 任务列表
GET    /api/crawler/detail/{id}  # 任务详情
DELETE /api/crawler/{id}         # 删除任务

# 数据处理
POST   /api/data/process         # 提交处理任务
GET    /api/data/preview/{id}    # 预览数据
GET    /api/data/export/{id}     # 导出数据

# 图表管理
POST   /api/chart/create         # 创建图表
GET    /api/chart/list           # 图表列表
GET    /api/chart/detail/{id}    # 图表详情
PUT    /api/chart/update/{id}    # 更新图表
DELETE /api/chart/{id}           # 删除图表
GET    /api/chart/data/{id}      # 获取图表数据
```

#### Python 服务接口
```
# 爬虫服务
POST   /crawler/start            # 启动爬虫
GET    /crawler/status/{task_id} # 查询状态
POST   /crawler/stop/{task_id}   # 停止爬虫

# 数据处理
POST   /process/execute          # 执行处理
GET    /process/result/{task_id} # 获取结果

# 词云生成
POST   /wordcloud/generate       # 生成词云
GET    /wordcloud/image/{id}     # 获取图片
GET    /wordcloud/freq/{id}      # 获取词频
```

---
